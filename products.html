<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TechPro | Electronic Surplus</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
  <div id="cartModal" class="modal-overlay">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Your Tech Bin</h2>
            <i class="fas fa-times close-modal" onclick="toggleModal()"></i>
        </div>
        <div id="cart-items-list">
            </div>
        <div class="modal-footer">
            <div class="total-row">
                <span>Estimated Total (Tax Incl.):</span>
                <span id="total-price">$0.00</span>
            </div>
            <button class="checkout-btn" onclick="processOrder()">Complete Purchase</button>
        </div>
    </div>
</div>

<style>
    /* --- Modal CSS --- */
    .modal-overlay {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0, 0, 0, 0.8); backdrop-filter: blur(5px);
        display: none; justify-content: center; align-items: center; z-index: 1000;
    }

    .modal-content {
        background: var(--bg-card); width: 90%; max-width: 500px;
        border-radius: 20px; padding: 30px; border: 1px solid var(--accent);
        box-shadow: 0 0 30px var(--accent-glow);
    }

    .modal-header { display: flex; justify-content: space-between; margin-bottom: 20px; }
    .close-modal { cursor: pointer; color: var(--text-dim); font-size: 1.5rem; }

    .cart-item {
        display: flex; justify-content: space-between; align-items: center;
        padding: 15px 0; border-bottom: 1px solid #334155;
    }

    .total-row {
        display: flex; justify-content: space-between; font-weight: bold;
        font-size: 1.2rem; margin: 25px 0; border-top: 2px solid var(--accent); padding-top: 15px;
    }

    .checkout-btn {
        width: 100%; padding: 15px; background: var(--accent);
        border: none; border-radius: 10px; font-weight: 800; cursor: pointer;
    }
</style>

<script>
    /* --- Updated JS Logic --- */
    let cart = [];

    function updateCart(id) {
        const item = products.find(p => p.id === id);
        cart.push(item);
        document.getElementById('cart-count').innerText = cart.length;
        renderCart();
    }

    function toggleModal() {
        const modal = document.getElementById('cartModal');
        modal.style.display = (modal.style.display === 'flex') ? 'none' : 'flex';
    }

    function renderCart() {
        const list = document.getElementById('cart-items-list');
        const totalEl = document.getElementById('total-price');
        
        if (cart.length === 0) {
            list.innerHTML = "<p style='text-align:center; color:gray;'>Your cart is empty.</p>";
            totalEl.innerText = "$0.00";
            return;
        }

        list.innerHTML = cart.map((item, index) => `
            <div class="cart-item">
                <div>
                    <strong>${item.name}</strong><br>
                    <small style="color:var(--accent)">${item.cat}</small>
                </div>
                <span>$${item.price}</span>
            </div>
        `).join('');

        const total = cart.reduce((sum, item) => sum + item.price, 0);
        totalEl.innerText = `$${total.toFixed(2)}`;
    }

    function processOrder() {
        alert("Order Initialized! Redirecting to secure payment gateway...");
        cart = [];
        document.getElementById('cart-count').innerText = "0";
        toggleModal();
        renderCart();
    }

    // Connect the cart icon in the Nav to the modal
    document.querySelector('.fa-shopping-cart').parentElement.onclick = toggleModal;
</script>
</head>
<body>

    <nav>
        <div class="logo">TECH<span style="color:white">PRO</span></div>
        <div class="search-container">
            <i class="fas fa-search"></i>
            <input type="text" id="searchInput" placeholder="Search components, peripherals, gear..." onkeyup="filterProducts()">
        </div>
        <div style="font-size: 1.2rem; cursor: pointer;">
            <i class="fas fa-shopping-cart"></i>
            <span id="cart-count" style="color:var(--accent)">0</span>
        </div>
    </nav>

    <div class="container">
        <div class="filter-bar">
            <button class="filter-btn active" onclick="setCategory('All', this)">All</button>
            <button class="filter-btn" onclick="setCategory('Storage', this)">Storage</button>
            <button class="filter-btn" onclick="setCategory('Peripherals', this)">Peripherals</button>
            <button class="filter-btn" onclick="setCategory('PC Parts', this)">PC Parts</button>
        </div>

        <div class="product-grid" id="productGrid">
            </div>
    </div>

    <script>
        const products = [
            { id: 1, name: "Mechanical Keyboard", price: 89, cat: "Peripherals", icon: "fa-keyboard", stock: "In Stock" },
            { id: 2, name: "M.2 NVMe SSD 2TB", price: 159, cat: "Storage", icon: "fa-hdd", stock: "In Stock" },
            { id: 3, name: "RTX 4070 GPU", price: 599, cat: "PC Parts", icon: "fa-microchip", stock: "Hot" },
            { id: 4, name: "Wireless Gaming Mouse", price: 45, cat: "Peripherals", icon: "fa-mouse", stock: "In Stock" },
            { id: 5, name: "External Hard Drive", price: 75, cat: "Storage", icon: "fa-save", stock: "Sale" },
            { id: 6, name: "RGB Case Fan (3 Pack)", price: 35, cat: "PC Parts", icon: "fa-fan", stock: "In Stock" }
        ];

        let currentCategory = 'All';
        let cartCount = 0;

        function renderProducts(data) {
            const grid = document.getElementById('productGrid');
            grid.innerHTML = data.map(p => `
                <div class="product-card">
                    <span class="badge">${p.stock}</span>
                    <div class="img-area"><i class="fas ${p.icon}"></i></div>
                    <p style="color: var(--accent); font-size: 0.8rem;">${p.cat}</p>
                    <h3 style="margin: 5px 0;">${p.name}</h3>
                    <div class="price-row">
                        <span class="price">$${p.price}</span>
                        <button class="add-btn" onclick="updateCart()">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function setCategory(cat, btn) {
            currentCategory = cat;
            // Update active button UI
            document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            filterProducts();
        }

        function filterProducts() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const filtered = products.filter(p => {
                const matchesCat = currentCategory === 'All' || p.cat === currentCategory;
                const matchesSearch = p.name.toLowerCase().includes(searchTerm);
                return matchesCat && matchesSearch;
            });
            renderProducts(filtered);
        }

        function updateCart() {
            cartCount++;
            document.getElementById('cart-count').innerText = cartCount;
        }

        // Initial Load
        renderProducts(products);
    </script>
</body>
</html>
